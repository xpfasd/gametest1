<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ç§»åŠ¨ç«¯Banneré«˜åº¦æµ‹è¯•</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #4CAF50 0%, #2196F3 100%);
            color: white;
            min-height: 100vh;
            padding: 10px;
            padding-bottom: 80px;
            overflow-x: hidden;
        }
        
        .mobile-container {
            max-width: 100%;
            margin: 0 auto;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            backdrop-filter: blur(5px);
        }
        
        h1 {
            font-size: 1.5em;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
        }
        
        .height-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin: 15px 0;
        }
        
        .height-btn {
            padding: 12px 6px;
            border: none;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            font-weight: bold;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            touch-action: manipulation;
        }
        
        .height-btn:active {
            transform: scale(0.95);
            background: #fff;
        }
        
        .height-btn.active {
            background: #FF5722;
            color: white;
        }
        
        .control-section {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .control-section h3 {
            font-size: 1.1em;
            margin-bottom: 10px;
            color: #FFE0B2;
        }
        
        .control-row {
            display: flex;
            gap: 8px;
            margin: 10px 0;
            flex-wrap: wrap;
        }
        
        .control-btn {
            flex: 1;
            min-width: 80px;
            padding: 10px;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            touch-action: manipulation;
        }
        
        .control-btn.primary {
            background: #4CAF50;
            color: white;
        }
        
        .control-btn.danger {
            background: #f44336;
            color: white;
        }
        
        .control-btn.info {
            background: #2196F3;
            color: white;
        }
        
        .status-card {
            background: rgba(0, 0, 0, 0.3);
            padding: 12px;
            border-radius: 6px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 11px;
            border-left: 3px solid #4CAF50;
            word-break: break-all;
        }
        
        .game-simulation {
            background: rgba(0, 0, 0, 0.3);
            height: 200px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 15px 0;
            border: 2px dashed rgba(255, 255, 255, 0.3);
            font-size: 16px;
        }
        
        .device-info {
            background: rgba(255, 193, 7, 0.2);
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 11px;
            border: 1px solid #FFC107;
        }
        
        /* å¼ºåˆ¶ç§»åŠ¨ç«¯æ ·å¼ */
        @media (max-width: 768px) {
            body {
                font-size: 14px;
            }
            
            .height-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .control-row {
                flex-direction: column;
            }
            
            .control-btn {
                flex: none;
                width: 100%;
            }
        }
        
        /* æ£€æµ‹Bannerå®¹å™¨çš„æ ·å¼è¦†ç›– */
        #poki-auto-banner-ad {
            transition: height 0.3s ease !important;
        }
    </style>
</head>
<body>
    <div class="mobile-container">
        <h1>ğŸ“± ç§»åŠ¨ç«¯Banneré«˜åº¦æµ‹è¯•</h1>
        
        <div class="device-info" id="device-info">
            æ­£åœ¨æ£€æµ‹è®¾å¤‡ä¿¡æ¯...
        </div>
        
        <div class="control-section">
            <h3>âš¡ å¿«é€Ÿé«˜åº¦é€‰æ‹©</h3>
            <div class="height-grid">
                <button class="height-btn" onclick="setMobileHeight(1)">1px</button>
                <button class="height-btn" onclick="setMobileHeight(2)">2px</button>
                <button class="height-btn" onclick="setMobileHeight(3)">3px</button>
                <button class="height-btn active" onclick="setMobileHeight(5)">5px</button>
                <button class="height-btn" onclick="setMobileHeight(8)">8px</button>
                <button class="height-btn" onclick="setMobileHeight(10)">10px</button>
                <button class="height-btn" onclick="setMobileHeight(15)">15px</button>
                <button class="height-btn" onclick="setMobileHeight(20)">20px</button>
                <button class="height-btn" onclick="setMobileHeight(25)">25px</button>
                <button class="height-btn" onclick="setMobileHeight(30)">30px</button>
                <button class="height-btn" onclick="setMobileHeight(40)">40px</button>
                <button class="height-btn" onclick="setMobileHeight(50)">50px</button>
            </div>
        </div>
        
        <div class="control-section">
            <h3>ğŸ® æ§åˆ¶æ“ä½œ</h3>
            <div class="control-row">
                <button class="control-btn danger" onclick="hideBanner()">éšè—</button>
                <button class="control-btn primary" onclick="showBanner()">æ˜¾ç¤º</button>
                <button class="control-btn info" onclick="refreshBanner()">åˆ·æ–°</button>
            </div>
            <div class="control-row">
                <button class="control-btn info" onclick="checkBannerSize()">æ£€æŸ¥å°ºå¯¸</button>
                <button class="control-btn info" onclick="forceMobileRefresh()">å¼ºåˆ¶ç§»åŠ¨ç«¯åˆ·æ–°</button>
            </div>
        </div>
        
        <div class="status-card" id="status">
            ç­‰å¾…æ“ä½œ...
        </div>
        
        <div class="game-simulation">
            ğŸ® æ¸¸æˆæ¨¡æ‹ŸåŒºåŸŸ<br>
            Bannerå°†åœ¨åº•éƒ¨æ˜¾ç¤º
        </div>
    </div>

    <!-- åŠ è½½PokiSDK -->
    <script src="scripts/v2/poki-sdk.js"></script>
    
    <script>
        let currentMobileHeight = 5;
        
        // æ£€æµ‹è®¾å¤‡ä¿¡æ¯
        function updateDeviceInfo() {
            const info = {
                userAgent: navigator.userAgent,
                screenWidth: screen.width,
                screenHeight: screen.height,
                windowWidth: window.innerWidth,
                windowHeight: window.innerHeight,
                devicePixelRatio: window.devicePixelRatio,
                isMobile: /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),
                isStandalone: window.navigator.standalone === true,
                viewportWidth: document.documentElement.clientWidth,
                viewportHeight: document.documentElement.clientHeight
            };
            
            document.getElementById('device-info').innerHTML = `
                ğŸ“± ${info.isMobile ? 'ç§»åŠ¨è®¾å¤‡' : 'æ¡Œé¢è®¾å¤‡'} | 
                å±å¹•: ${info.screenWidth}Ã—${info.screenHeight} | 
                è§†å£: ${info.viewportWidth}Ã—${info.viewportHeight} | 
                DPR: ${info.devicePixelRatio}
            `;
        }
        
        function updateStatus(message) {
            const timestamp = new Date().toLocaleTimeString();
            document.getElementById('status').innerHTML = `
                <strong>çŠ¶æ€:</strong> ${message}<br>
                <strong>å½“å‰é«˜åº¦:</strong> ${currentMobileHeight}px<br>
                <strong>æ—¶é—´:</strong> ${timestamp}
            `;
        }
        
        function setMobileHeight(height) {
            currentMobileHeight = height;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.height-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            updateStatus(`æ­£åœ¨è®¾ç½®ç§»åŠ¨ç«¯Banneré«˜åº¦ä¸º ${height}px...`);
            
            // è®¾ç½®é…ç½®
            PokiSDK.setAutoBannerConfig({
                height: height
            });
            
            // åœ¨ç§»åŠ¨ç«¯ï¼Œå¼ºåˆ¶åˆ·æ–°Banner
            setTimeout(() => {
                forceMobileRefresh();
                updateStatus(`âœ… ç§»åŠ¨ç«¯Banneré«˜åº¦å·²è®¾ç½®ä¸º ${height}px`);
            }, 300);
        }
        
        function hideBanner() {
            PokiSDK.enableAutoBanner(false);
            const banner = document.getElementById('poki-auto-banner-ad');
            if (banner) {
                banner.remove();
            }
            updateStatus('âŒ Bannerå·²éšè—');
        }
        
        function showBanner() {
            PokiSDK.enableAutoBanner(true);
            updateStatus('ğŸ”„ æ­£åœ¨æ˜¾ç¤ºBanner...');
            
            setTimeout(() => {
                updateStatus('âœ… Bannerå·²æ˜¾ç¤º');
                checkBannerSize();
            }, 1000);
        }
        
        function refreshBanner() {
            updateStatus('ğŸ”„ æ­£åœ¨åˆ·æ–°Banner...');
            PokiSDK.refreshBanner();
            
            setTimeout(() => {
                updateStatus('âœ… Banneråˆ·æ–°å®Œæˆ');
                checkBannerSize();
            }, 800);
        }
        
        function forceMobileRefresh() {
            updateStatus('ğŸ“± å¼ºåˆ¶ç§»åŠ¨ç«¯åˆ·æ–°...');
            
            // å…ˆç§»é™¤ç°æœ‰Banner
            const existingBanner = document.getElementById('poki-auto-banner-ad');
            if (existingBanner) {
                existingBanner.remove();
                console.log('ç§»åŠ¨ç«¯å¼ºåˆ¶åˆ·æ–°: ç§»é™¤ç°æœ‰Banner');
            }
            
            // å»¶è¿Ÿé‡æ–°åˆ›å»ºï¼Œç¡®ä¿ç§»åŠ¨ç«¯æ¸²æŸ“å®Œæˆ
            setTimeout(() => {
                PokiSDK.refreshBanner();
                updateStatus('ğŸ“± ç§»åŠ¨ç«¯å¼ºåˆ¶åˆ·æ–°å®Œæˆ');
                
                setTimeout(checkBannerSize, 500);
            }, 200);
        }
        
        function checkBannerSize() {
            const banner = document.getElementById('poki-auto-banner-ad');
            if (banner) {
                const rect = banner.getBoundingClientRect();
                const computedStyle = window.getComputedStyle(banner);
                
                updateStatus(`
                    ğŸ“ ç§»åŠ¨ç«¯Bannerå°ºå¯¸:<br>
                    - å®é™…é«˜åº¦: ${rect.height}px<br>
                    - CSSé«˜åº¦: ${computedStyle.height}<br>
                    - æœ€å°é«˜åº¦: ${computedStyle.minHeight}<br>
                    - æœ€å¤§é«˜åº¦: ${computedStyle.maxHeight}<br>
                    - é…ç½®é«˜åº¦: ${currentMobileHeight}px<br>
                    - ä½ç½®: top=${Math.round(rect.top)}px, bottom=${Math.round(rect.bottom)}px<br>
                    - æ˜¯å¦å¯è§: ${rect.height > 0 ? 'âœ…' : 'âŒ'}<br>
                    - å®½åº¦: ${rect.width}px (${Math.round(rect.width/window.innerWidth*100)}%å±å®½)
                `);
                
                console.log('ç§»åŠ¨ç«¯Banneræ£€æŸ¥:', {
                    actualHeight: rect.height,
                    configHeight: currentMobileHeight,
                    cssHeight: computedStyle.height,
                    minHeight: computedStyle.minHeight,
                    maxHeight: computedStyle.maxHeight,
                    position: rect
                });
            } else {
                updateStatus('âŒ æœªæ‰¾åˆ°Bannerå…ƒç´ ');
            }
        }
        
        // ç›‘å¬å±å¹•æ–¹å‘å˜åŒ–
        function handleOrientationChange() {
            setTimeout(() => {
                updateDeviceInfo();
                updateStatus('ğŸ“± å±å¹•æ–¹å‘å·²å˜æ›´ï¼Œæ­£åœ¨æ£€æŸ¥Banner...');
                setTimeout(checkBannerSize, 300);
            }, 100);
        }
        
        window.addEventListener('orientationchange', handleOrientationChange);
        window.addEventListener('resize', handleOrientationChange);
        
        // ç›‘å¬Banneräº‹ä»¶
        window.addEventListener('bannerAdLoaded', function(event) {
            console.log('ç§»åŠ¨ç«¯BanneråŠ è½½æˆåŠŸ:', event.detail);
            updateStatus('âœ… ç§»åŠ¨ç«¯Bannerå¹¿å‘ŠåŠ è½½æˆåŠŸ!');
            setTimeout(checkBannerSize, 200);
        });
        
        window.addEventListener('bannerAdError', function(event) {
            console.log('ç§»åŠ¨ç«¯BanneråŠ è½½å¤±è´¥:', event.detail);
            updateStatus('âŒ ç§»åŠ¨ç«¯BanneråŠ è½½å¤±è´¥: ' + event.detail.error);
        });
        
        // é¡µé¢åŠ è½½å®Œæˆ
        window.addEventListener('load', function() {
            updateDeviceInfo();
            setTimeout(() => {
                updateStatus('ğŸ“± ç§»åŠ¨ç«¯é¡µé¢åŠ è½½å®Œæˆ');
                setTimeout(checkBannerSize, 2000);
            }, 1000);
        });
        
        // å®šæœŸæ£€æŸ¥BannerçŠ¶æ€
        setInterval(() => {
            const banner = document.getElementById('poki-auto-banner-ad');
            if (banner) {
                const rect = banner.getBoundingClientRect();
                if (Math.abs(rect.height - currentMobileHeight) > 2) {
                    console.log(`ç§»åŠ¨ç«¯é«˜åº¦å¼‚å¸¸: å®é™…=${rect.height}px, æœŸæœ›=${currentMobileHeight}px`);
                }
            }
        }, 5000);
        
        // è§¦æ‘¸äº‹ä»¶ä¼˜åŒ–
        document.addEventListener('touchstart', function() {}, {passive: true});
        document.addEventListener('touchmove', function() {}, {passive: true});
    </script>
</body>
</html> 